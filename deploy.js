const { REST, Routes } = require("discord.js"); const path = require("path"); const fs = require("fs"); function loadCommands() { const commands = []; const commandsPath = path.join(__dirname, "src/commands"); const versions = ["v1", "v2", "premium"]; for (const version of versions) { const versionPath = path.join(commandsPath, version); if (!fs.existsSync(versionPath)) continue; const commandFiles = fs.readdirSync(versionPath).filter(f => f.endsWith(".js")); for (const file of commandFiles) { try { const command = require(path.join(versionPath, file)); if ("data" in command && "execute" in command) { commands.push(command.data.toJSON()); } } catch (e) { console.log("Error: " + e.message); } } } return commands; } async function deploy() { const commands = loadCommands(); console.log("Loaded: " + commands.length); const envPath = path.join(__dirname, ".env"); let token = "", id = ""; if (fs.existsSync(envPath)) { const c = fs.readFileSync(envPath, "utf8"); c.split("\n").forEach(l => { if (l.startsWith("DISCORD_TOKEN=")) token = l.split("=")[1].trim(); if (l.startsWith("CLIENT_ID=")) id = l.split("=")[1].trim(); }); } if (!token || !id) { console.log("ERROR: Missing values"); return; } const rest = new REST().setToken(token); try { console.log("Deploying..."); const r = await rest.put(Routes.applicationCommands(id), { body: commands }); console.log("SUCCESS! " + r.length + " commands"); } catch (e) { console.log("ERROR: " + e.message); } } deploy();
